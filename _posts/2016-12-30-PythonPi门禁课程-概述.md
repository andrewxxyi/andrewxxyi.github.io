---
layout: post
title: PythonPi门禁课程-概述
date: 2016-12-30
---
门禁系统是安保系统中最常用的安全防护系统之一。和控制系统相关的主要包括如下部分：

#### 门控制器

也就是通用的控制模型中的裁决器，一般都直接集成了前端信号、动作执行的接线端子。一般分为单门或双门，多个门控制器可组成一个较大的门禁控制系统，一般采用RS485或TCP/IP进行组网：

  ![](http://course.pythonpi.top:10008/course/3-用PythonPi实现门禁/1-概述/1.png)

它一般提供了读卡器、出门按钮、电锁电源控制继电器、锁状态（门磁）的接口，也就是上图中控制板两侧的那些绿色接线端子。

门控制器本质上就是执行门开关控制功能的裁决器。为了简化工程施工，一般门开关的控制功能都是固化到门控制器中的。如：

- 按出门按钮则电锁电源继电器动作，开启电锁

- 刷卡有权进入则电锁电源继电器动作，开启电锁

此外，门控制器一般还会额外提供几个输入接口，可以提供现场的报警信号接入用于联动功能，如烟感（火警）告警则开门。

一般一个读卡器接口、一个出门按钮接口、一个电锁电源控制继电器、一个门状态接口组成了一个标准的门，提供了一个门的所有接口的叫做单门控制器，提供了两个门的所有接口的叫做双门控制器。由于门的密度不可能很大，所以一般不会再提供更多门的控制器了。否则，门控制器距离门的距离过远，会导致读卡器接线的长度太长，可能会导致读卡器工作不正常。

因此，当有多道门需要控制时，就需要多个门控制器。而由于读卡器读卡后，需要进行该卡是否有开门权限的判别，所以门控制器需要知道各卡号和相应的权限，这样一来，如果每增加一个卡就要在每个门控制器上增加该卡的卡号和相应权限，则工程上会非常麻烦，不仅会导致施工成本过高，关键是这样的操作很容易产生疏漏，管理成本过高。所以如果有多个门，一般需要将所有的门控制器联网，统一由一个称之为上位机的管理系统进行卡数据的录入和下发等管理工作。

门控制器的联网一般采用RS485或TCP/IP。RS485简单可靠、成本也低，但485总线的长度在工程上一般最多只放到1千米左右，如果门数较多，覆盖范围较广，则需要将其切分到多条总线。

`在PythonPi平台上，起到门控制器作用的当然是我们的PythonPi系统，本课程就是讲解如何用PythonPi平台来实现门禁系统`

#### 读卡器

从工程上考虑采用何种技术，当然首先是考虑采购成本，其次是考虑施工成本，然后是考虑可靠性、稳定性，最后是考虑维护简便。

所以从目前的技术成熟度来看，虽然生物识别、视频图像识别一定是未来的方向，但目前以及未来数年一定还是以卡片为主。目前的卡片技术主要包括ID卡、IC卡，IC卡的读取速度、安全性、可交换的数据都具有明显的优势，但就门禁系统来说，只需要用卡号来标识持卡人即可，而卡本身的安全性就非常低，所以对门禁系统来说，ID卡、IC卡其实并没有太大的区别，完全应该纳入到整个一卡通系统选型中来考虑。

  ![读卡器](http://course.pythonpi.top:10008/course/3-用PythonPi实现门禁/1-概述/2.png)

以我们前文所述，一道门一般由一个读卡器接口、一个出门按钮接口、一个电锁电源控制继电器、一个门状态接口组成。一般情况下，读卡器安装到门外、出门按钮装到门内。也就是说，`门外属于非安全区域，而门内属于相对安全区域`，进门需要管控，而出门则不需管控。

由于电子技术的快速发展，现在有些读卡器和门控制器结合在一起，可用于低成本的单门管控。由于读卡器一般安装到门外，而刚刚说了门外属于非安全区域，所以这种读卡器其实就是将最重要的门控制器也一并安装到了非安全区域，如果读卡器被破拆，然后直接将锁控制线剪掉，则门就会打开（因为考虑到人员安全，一般都采用断电开锁），所以这种读卡器即便有防破拆设计也毫无安全性可言。而独立的读卡器由于门控制器安装在安全区域，则读卡器被破拆也无法送入合法的卡号来打开门。

有的门禁系统取消了门内的出门按钮，增加一个门内的读卡器，不过这种配置一般不是出于安全的考虑而是用于进出管控，如考勤之类的目的。

有些读卡器还配有键盘，可通过按密码来实现开门。不过这种密码从来不换，而且只要认识门内的人就可以知道密码，所以密码方式根本起不到门禁的作用，只是一个心理安慰而已，还浪费了人员进出的时间。

读卡器和门控制器的接口传统上采用韦根接口，有韦根26位、34位之类的区别。由于韦根接口距离较近，而且需要专用的读卡器接口，所以现在也有RS485和TCP/IP这样的读卡器了。不过TCP/IP接口的读卡器目前成本还是比较高，485接口的读卡器其性价比会非常高。

我们这个课程所采用的实验用读卡器是RC522 IC读卡器，淘宝都有售，价格低于20元，还送卡，性价比非常高。RC522通过SPI接口和树莓派相连，这种接口不适合工程上使用，但用于我们的实验，则非常好。

  ![读卡器](http://course.pythonpi.top:10008/course/3-用PythonPi实现门禁/1-概述/3.png)

`注意：RC522读卡器需要焊接读卡器管脚`

#### 电锁

常用的电锁有：

- 电磁锁：以玻璃门使用为主，由于安装简便、可靠性高，所以目前应用越来越广泛。电磁锁的原理是在门上装一个铁板，在门框上装一个可通电的硅钢片，当给硅钢片通电时，会产生强大的磁力牢牢吸附住铁板，一般都可以达到两三百公斤以上的拉力，即便是非常强壮的男子也无法将之拉开。但这样一来，就有两个问题，一是门框上安装的锁体会限制门体的运动，所以安装电磁锁的门就只能一个方向打开了；二是由于电磁锁一旦断电就会开锁，因此需要通电的锁体必须安装在较为安全的门内，所以锁体的安装要求较高

  ![电锁](http://course.pythonpi.top:10008/course/3-用PythonPi实现门禁/1-概述/4.png)

  ![电锁](http://course.pythonpi.top:10008/course/3-用PythonPi实现门禁/1-概述/5.png)

- 电插锁（阳极锁，即受控的是可伸缩的锁舌）：也多用于玻璃门，阳极锁的优势是锁舌缩回锁体后，不会影响门体的移动，所以门可以双向打开。不象其它锁会限制门只能单向打开，但由于需要锁舌和锁孔对准，而门可以双向打开就意味着没法向其它锁对门体有位置限制，所以在长时间使用后可能会出现门体位置的偏差，从而导致锁舌和锁孔对不准的现象，也就是门锁不上了。而由于没有门框的辅助，在锁门的情况下如果有人大力推门，力量全落在锁舌上，如果较频繁的出现这种情况，可能会造成锁舌变形，严重时会导致锁舌卡死，将人关在门内，而且这种故障是机械性故障，必须将锁体破拆才可以修复。所以目前这种锁的应用已越来越少

  ![电锁](http://course.pythonpi.top:10008/course/3-用PythonPi实现门禁/1-概述/6.png)

  ![电锁](http://course.pythonpi.top:10008/course/3-用PythonPi实现门禁/1-概述/7.png)

- 电插锁（阴极锁，即受控的是埋藏在锁体中的锁扣）：一般用于木门之类对美观要求较高的场合，但由于锁体需要隐藏安装到门框中，所以对施工要求较高

  ![电锁](http://course.pythonpi.top:10008/course/3-用PythonPi实现门禁/1-概述/8.png)

  ![电锁](http://course.pythonpi.top:10008/course/3-用PythonPi实现门禁/1-概述/9.png)
  
电锁的选择首先看门，玻璃门就选电磁锁，木门可能就得选阴极锁了；如果是电磁锁，还需要考虑锁体的安全来选择锁体的安装位置和安装附件。

#### 出门按钮和门状态检测

其实这两者都没有什么太好说的，出门按钮就是一个开关，只是要做的醒目点、好看点，高端大气上档次：

  ![出门按钮](http://course.pythonpi.top:10008/course/3-用PythonPi实现门禁/1-概述/10.png)

而门是开是关的状态检测其实就是在门和门框上定位安装两个磁体，当门关闭后两个磁体对好则会产生一个信号。安到门上监控门是否开启的叫门磁，装到窗上的叫窗磁：

  ![门磁](http://course.pythonpi.top:10008/course/3-用PythonPi实现门禁/1-概述/11.png)

  ![门磁](http://course.pythonpi.top:10008/course/3-用PythonPi实现门禁/1-概述/12.png)

但门嘛，一般都是门脸，比较引人瞩目，需要门禁管控设备尽量少些、整洁些、美观些，设备接线也最好是越少越好。因此门磁结构简单，所以现在一般都集成到电锁中了，不再额外跑线装个单独的门磁。

#### 一卡通

卡片式门禁系统现在的一个趋势就是一卡通，但一卡通涵盖了安防系统、信息管理系统、消费系统等，这些系统的要求是有本质区别的，统一纳入一个系统进行管理其实非常困难，所以很多一卡通只是一张卡而多个应用系统，但这也造成系统管理方面的困难。从未来的趋势来看，因为一张卡其实对应了一个人，想用一个系统就提供所有的应用是不现实的，而随着生物识别技术的发展，个人身边将围绕着各种各样的信息系统，而个体和这些系统的互动也是随时随地的。打通这些系统是智能时代的基本要求，也是非常困难的基础工作。核心难点是各应用的需求千差万别，而且新应用层出不穷，因此投入巨大却无法满足需要。

====================================================================================================

`关注我的公众号及时获取推送的最新文章`

  ![公众号](http://course.pythonpi.top:10008/images/qrcode.jpg)

